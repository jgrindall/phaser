define(["jquery","app/scenemanager/scenemanager","app/game"],function(a,b,c){"use strict";var d=function(){};return d.launch=function(){var d,e;e=new b,d={create:a.proxy(e.create,e),preload:a.proxy(e.preload,e)},c.init(d)},d.resize=function(){console.log("resize")},d.start=function(){a(window).resize(a.proxy(d.resize,this)),a(document).ready(d.launch)},d}),define(["app/scenes/comms/commslayout","app/consts/leveldata","app/scenes/game/gamemode","app/scenes/game/objectstate"],function(a,b,c,d){"use strict";var e=function(){this.selectedIndex=0,this.layoutSignal=new Phaser.Signal,this.tabSignal=new Phaser.Signal};return e.prototype.setSelectedTab=function(a){this.selectedIndex=a.index,this.tabSignal.dispatch()},e.prototype.init=function(a){this.selectedIndex=0,this.tiles=[];var b=this;a&&$.each(new Array(a.tabs),function(a){b.tiles[a]=[]}),this.mode=c.UNKNOWN},e.prototype.getTilesLayout=function(c){var d,e,f,g;return d=this.tiles[c],e=[],g=a.TOP,f=a.XPOS,$.each(d,function(c,d){var h,i,j;i=b.getIndents(d.type),j=b.getUnindents(d.type),j&&(f-=a.INDENT),h={type:d.type,index:d.index,x:f,y:g},e.push(h),g+=a.getBlockHeight(d.type),i&&(f+=a.INDENT)}),{index:c,positions:e}},e.prototype.getCommands=function(){return[d.UPRIGHT,d.UPLEFT,d.UP,d.RIGHT,d.UP,d.UPRIGHT]},e.prototype.layoutCurrentTiles=function(){var a=[];a.push(this.getTilesLayout(this.selectedIndex)),this.layoutSignal.dispatch(a)},e.prototype.layoutAllTiles=function(){var a=this,b=[];$.each(this.tiles,function(c){var d=a.getTilesLayout(c);b.push(d)}),this.layoutSignal.dispatch(b)},e.prototype.log=function(){var a=this.currentTiles(),b="";$.each(a,function(a,c){b+="\n"+a+"   "+JSON.stringify(c)}),console.log("LOG s: "+b)},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.currentTiles=function(){var a=this.tiles[this.selectedIndex];return console.log("tiles "+JSON.stringify(this.tiles)+" , "+this.selectedIndex),a},e.prototype.getDropPosition=function(b){var c,d,e,f,g;return c=this.currentTiles(),d=a.getBlockHeight(b.id.type),0===c.length?{y:0,indents:0}:(e=b.sprite.y+d/2,f=(e-a.TOP)/d,f=Math.min(Math.floor(f+.5),c.length+1),g=(b.sprite.x-a.XPOS)/a.INDENT,g=Math.max(0,g),{y:f,indents:g})},e.prototype.drop=function(a){var b=this.getDropPosition(a);console.log("index "+b.y+",  "+b.indents);var c=this.currentTiles();c.splice(b.y,0,a.id),this.layoutCurrentTiles()},e.prototype.reload=function(a){this.layoutAllTiles(a)},e.prototype.getIndexOf=function(a,b){var c=-1;return $.each(a,function(a,d){d.type===b.type&&d.index===b.index&&(c=a)}),c},e.prototype.lift=function(a){var b=(a.id,this.currentTiles()),c=this.getIndexOf(b,a.id);b.splice(c,1),this.layoutCurrentTiles()},e}),define(["app/components/buttons/tickbutton","app/game","app/components/container","app/utils/textfactory"],function(a,b,c,d){"use strict";var e=function(a){c.call(this,a),this.selectSignal=new Phaser.Signal,this.buttons=[]};return e.prototype=Object.create(c.prototype),e.prototype.constructor=e,e.prototype.addRect=function(){this.panel=new Phaser.Sprite(b.getInstance(),this.bounds.x,this.bounds.y,this.options.bgasset),this.group.add(this.panel)},e.prototype.addBg=function(){this.rect=new Phaser.Graphics(b.getInstance(),0,0),this.rect.beginFill(0),this.rect.alpha=.7,this.rect.drawRect(0,0,b.w(),b.h()),this.group.add(this.rect)},e.prototype.addText=function(){this.label=d.make(b.cx()-150,this.bounds.y+20,this.options.label,d.SMALL),this.group.add(this.label)},e.prototype.addButtons=function(){this.buttonGroup=new Phaser.Group(b.getInstance(),0,0),this.group.add(this.buttonGroup)},e.prototype.addOk=function(){var c,d,e;c=b.cx()-a.WIDTH/2,d=this.bounds.y+this.bounds.h-a.HEIGHT,e=new a({x:c,y:d}),e.create(),e.mouseUpSignal.add(this.buttonUp,this),this.group.add(e.sprite)},e.prototype.create=function(){c.prototype.create.call(this),this.addBg(),this.addRect(),this.addButtons(),this.addText()},e.prototype.buttonUp=function(a){var b=this.buttonGroup.getIndex(a.target.sprite);this.selectSignal.dispatch({index:b})},e.prototype.destroy=function(){$.each(this.buttons,function(a,b){b.mouseUpSignal.removeAll(this)}),c.prototype.destroy.call(this)},e}),define(["app/components/buttons/tickbutton","app/game","app/components/container","app/utils/textfactory","app/components/abstractpopup"],function(a,b,c,d,e){"use strict";var f=function(a){a.bgasset="alert",e.call(this,a)};return f.prototype=Object.create(e.prototype),f.prototype.constructor=f,f.WIDTH=400,f.HEIGHT=200,f.prototype.addOk=function(){var c,d,e;c=b.cx()-a.WIDTH/2,d=this.bounds.y+this.bounds.h-a.HEIGHT,e=new a({x:c,y:d}),e.create(),e.mouseUpSignal.add(this.buttonUp,this),this.group.add(e.sprite),this.buttons.push(e)},f.prototype.addButtons=function(){e.prototype.addButtons.call(this),this.addOk()},f}),define(["app/game"],function(a){"use strict";var b=function(a){this.options=a};return b.prototype.destroy=function(){this.sprite.destroy(!0),this.sprite=null},b.prototype.create=function(){var b,c;b=a.getWidth(),c=a.getHeight(),this.sprite=new Phaser.TileSprite(a.getInstance(),0,0,b,c,this.options.asset),this.sprite.fixedToCamera=!0},b}),define(["app/game","app/components/container"],function(a,b){"use strict";var c=function(a){b.call(this,a),this.config=this.options.config||[],this.spaceX=this.bounds.w/this.options.numX,this.spaceY=this.bounds.h/this.options.numY,this.marginX=(this.spaceX-this.options.buttonClass.WIDTH)/2,this.marginY=(this.spaceY-this.options.buttonClass.HEIGHT)/2,this.signal=new Phaser.Signal};return c.prototype=Object.create(b.prototype),c.prototype.constructor=c,c.prototype.create=function(){b.prototype.create.call(this),this.addBg(),this.addButtons()},c.prototype.addBg=function(){this.panel=new Phaser.Sprite(a.getInstance(),this.bounds.x,this.bounds.y,"panel"),this.group.add(this.panel)},c.prototype.addButtons=function(){var b,c,d,e,f=0;for(this.buttonGroup=new Phaser.Group(a.getInstance(),0,0),c=1;c<=this.options.numY;c++)for(d=1;d<=this.options.numX;d++)b={x:this.bounds.x+this.spaceX*(d-1),y:this.bounds.y+this.spaceY*(c-1)},b.x+=this.marginX,b.y+=this.marginY,e=new this.options.buttonClass({bounds:b,index:f,state:this.config[f]}),e.create(),e.mouseUpSignal.add(this.buttonUp,this),this.buttonGroup.add(e.group),f++;this.group.add(this.buttonGroup)},c.prototype.destroy=function(){b.prototype.destroy.call(this)},c.prototype.buttonUp=function(a){var b=this.buttonGroup.getIndex(a.target.group);this.signal.dispatch({index:b,grid:this})},c}),define(["app/game"],function(a){"use strict";var b=function(a){this.options=a,this.asset=this.options.asset,this.mouseDownSignal=new Phaser.Signal,this.mouseUpSignal=new Phaser.Signal};return b.prototype.goToFrame=function(a){this.sprite.setFrames(a,a,a,a)},b.prototype.resetFrames=function(){this.sprite.setFrames(0,1,2,3)},b.prototype.callback=function(){},b.prototype.create=function(){this.sprite=new Phaser.Button(a.getInstance(),0,0,this.asset,this.callback,this,0,1,2,3),this.sprite.events.onInputUp.add(this.mouseUp,this),this.sprite.events.onInputDown.add(this.mouseDown,this),this.sprite.x=this.options.x,this.sprite.y=this.options.y,this.resetFrames(),this.enableInput()},b.prototype.mouseUp=function(){this.mouseUpSignal.dispatch({target:this})},b.prototype.enableInput=function(){this.sprite.inputEnabled=!0},b.prototype.disableInput=function(){this.sprite.inputEnabled=!1},b.prototype.mouseDown=function(){this.mouseDownSignal.dispatch({target:this})},b.prototype.update=function(){},b.prototype.destroy=function(){this.sprite.inputEnabled=!1,this.sprite.destroy(!0),this.mouseDownSignal=null,this.mouseUpSignal=null},b}),define(["app/components/buttons/abstractbutton"],function(a){"use strict";var b=function(b){b.asset="bulb",a.call(this,b)};return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.WIDTH=120,b.HEIGHT=120,b}),define(["app/components/buttons/abstractbutton"],function(a){"use strict";var b=function(b){b.asset="close",a.call(this,b)};return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b}),define(["app/components/buttons/abstractbutton"],function(a){"use strict";var b=function(b){a.call(this,b)};return b.HEIGHT=120,b.WIDTH=120,b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.prototype.create=function(){a.prototype.create.apply(this,arguments)},b}),define(["app/components/buttons/abstractbutton"],function(a){"use strict";var b=function(b){b.asset="home",a.call(this,b)};return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b}),define(["app/components/buttons/levelsbutton","app/game","app/components/container","app/utils/textfactory","app/levelstate"],function(a,b,c,d,e){"use strict";var f=function(a){c.call(this,a),this.state=this.options.state,this.mouseUpSignal=new Phaser.Signal};return f.prototype=Object.create(c.prototype),f.prototype.constructor=f,f.prototype.addText=function(){var a=""+(this.options.index+1);this.label=d.make(this.options.bounds.x+40,this.options.bounds.y+10,a,d.LARGE),this.group.add(this.label)},f.prototype.select=function(){this.mouseUpSignal.dispatch({target:this})},f.prototype.getAsset=function(){return f.ASSETS[this.state]},f.prototype.addMain=function(){this.button=new a({x:this.options.bounds.x,y:this.options.bounds.y,asset:this.getAsset()}),this.button.create(),this.button.mouseUpSignal.add(this.select,this),this.group.add(this.button.sprite)},f.prototype.create=function(){c.prototype.create.call(this),this.addMain(),this.addText()},f.prototype.destroy=function(){this.button.mouseUpSignal.removeAll(this),c.prototype.destroy.call(this),this.mouseUpSignal=null,this.label=null,this.button=null},f.WIDTH=150,f.HEIGHT=150,f.ASSETS=[],f.ASSETS[e.OPEN]="levelbutton",f.ASSETS[e.LOCKED]="levelbuttonlocked",f.ASSETS[e.COMPLETED]="levelbuttondone",f}),define(["app/components/buttons/abstractbutton"],function(a){"use strict";var b=function(b){a.call(this,b)};return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.WIDTH=150,b.HEIGHT=150,b}),define(["app/components/buttons/abstractbutton"],function(a){"use strict";var b=function(b){b.asset="list",a.call(this,b)};return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.WIDTH=120,b.HEIGHT=120,b}),define(["app/components/buttons/abstractbutton"],function(a){"use strict";var b=function(b){b.asset="marker",a.call(this,b)};return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.prototype.select=function(){this.goToFrame(2)},b.prototype.deselect=function(){this.goToFrame(1)},b}),define(["app/components/buttons/abstractbutton"],function(a){"use strict";var b=function(b){b.asset="play",a.call(this,b)};return b.WIDTH=120,b.HEIGHT=120,b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b}),define(["app/components/buttons/abstractbutton"],function(a){"use strict";var b=function(b){b.asset="pause",a.call(this,b)};return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.WIDTH=120,b.HEIGHT=120,b}),define(["app/components/buttons/abstractbutton"],function(a){"use strict";var b=function(b){b.asset="tabbutton"+b.num,a.call(this,b)};return b.WIDTH=244,b.HEIGHT=52,b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.prototype.create=function(){a.prototype.create.apply(this,arguments)},b.prototype.select=function(){this.goToFrame(1)},b.prototype.deselect=function(){this.goToFrame(0)},b}),define(["app/components/buttons/abstractbutton"],function(a){"use strict";var b=function(b){b.asset="tick",a.call(this,b)};return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.WIDTH=80,b.HEIGHT=80,b}),define(["app/game"],function(a){"use strict";var b=function(a){this.options=a||{},this.options.bounds||(this.options.bounds={}),this.bounds=this.options.bounds};return b.prototype.create=function(){this.group=new Phaser.Group(a.getInstance())},b.prototype.destroy=function(){this.group.removeAll(!0)},b}),define(["app/game","app/components/buttons/markerbutton","app/components/container"],function(a,b,c){"use strict";var d=function(a){c.call(this,a),this.buttons=[]};return d.prototype=Object.create(c.prototype),d.prototype.constructor=d,d.prototype.create=function(){c.prototype.create.call(this);var d,e,f;for(e=0;e<=this.options.num-1;e++)f=a.cx()-20*this.options.num+40*e,d=new b({x:f,y:a.h()-40}),d.create(),this.group.add(d.sprite),this.buttons.push(d);this.setSelected(0)},d.prototype.destroy=function(){c.prototype.destroy.call(this)},d.prototype.setSelected=function(a){$.each(this.buttons,function(b,c){b===a?c.select():c.deselect()})},d}),define(["app/components/buttons/tickbutton","app/game","app/components/container","app/utils/textfactory","app/components/abstractpopup"],function(a,b,c,d,e){"use strict";var f=function(a){a.bgasset="alert",e.call(this,a)};return f.prototype=Object.create(e.prototype),f.prototype.constructor=f,f.WIDTH=400,f.HEIGHT=200,f.prototype.addOk=function(){var c,d,e;c=b.cx()-a.WIDTH/2,d=this.bounds.y+this.bounds.h-a.HEIGHT,e=new a({x:c,y:d}),e.create(),e.mouseUpSignal.add(this.buttonUp,this),this.group.add(e.sprite),this.buttons.push(e)},f.prototype.addButtons=function(){e.prototype.addButtons.call(this),this.addOk()},f}),define(["app/game"],function(a){"use strict";var b=function(a){this.options=a};return b.WIDTH=500,b.HEIGHT=60,b.prototype.goToPercent=function(a){var b,c;c=8,b=(c-1)/100,this.sprite.x=this.options.x,this.sprite.y=this.options.y,this.sprite.loadTexture("loaderBar",Math.round(a*b))},b.prototype.create=function(){this.sprite=new Phaser.Sprite(a.getInstance(),500,60,"loaderBar")},b.prototype.destroy=function(){this.sprite.destroy(!0),this.sprite=null},b}),define(["app/game","app/components/scroller","app/components/groupmarker"],function(a,b,c){"use strict";var d=function(c){c.snapX=a.w(),b.call(this,c)};return d.prototype=Object.create(b.prototype),d.prototype.constructor=d,d.prototype.addChildren=function(){b.prototype.addChildren.call(this),this.groupMarker=new c({num:this.options.dataProvider.getNumPages()}),this.groupMarker.create(),a.getInstance().world.add(this.groupMarker.group)},d.prototype.destroy=function(){b.prototype.destroy.call(this),this.groupMarker=null},d.prototype.snap=function(){b.prototype.snap.call(this);var c=-1*Math.round(this.group.x/a.w());this.groupMarker&&this.groupMarker.setSelected(c)},d}),define(["app/game"],function(a){"use strict";var b=function(a){this.options=a,this.x0=null,this.dragging=!1,this.minX=0,this.selectSignal=new Phaser.Signal};return b.MIN_MOVE=10,b.prototype.create=function(){this.group=new Phaser.Group(a.getInstance()),this.addChildren(),a.getInput().onDown.add($.proxy(this.onDown,this)),a.getInput().mouse.mouseOutCallback=$.proxy(this.mouseOutCallback,this)},b.prototype.mouseOutCallback=function(){this.onUp()},b.prototype.add=function(b){this.group.add(b.group);var c,d,e;c=b.options.bounds.x,d=b.options.bounds.w,e=a.w(),this.minX=Math.min(this.minX,-1*(c+d-e)),b.signal.add($.proxy(this.select,this))},b.prototype.select=function(a){if(Math.abs(this.dx)<b.MIN_MOVE){var c=this.group.getIndex(a.grid.group);this.selectSignal.dispatch({key:this.key,level:a.index,page:c})}},b.prototype.addChildren=function(){this.options.dataProvider.addAll(this)},b.prototype.onDown=function(){this.startDragging()},b.prototype.onUp=function(){this.dragging=!1,a.getInput().moveCallback=null,this.snap()},b.prototype.snap=function(){var b=this.options.snapX*Math.round(this.group.x/this.options.snapX);a.getInstance().add.tween(this.group).to({x:b},250,Phaser.Easing.Quadratic.Out,!0,20,!1)},b.prototype.buttonUp=function(c){a.getInput().moveCallback=null,this.x0=null;this.group.getIndex(c.target.sprite);Math.abs(this.dx)>b.MIN_MOVE&&this.snap()},b.prototype.move=function(a,b){var c;null===this.x0&&(this.x0=b),this.dx=this.x0-b,c=this.startX-this.dx,c=Math.min(Math.max(c,this.minX),0),this.group.x=c},b.prototype.startDragging=function(){this.startX=this.group.x,this.dx=0,this.x0=null,this.dragging=!0,a.getInput().onUp.add($.proxy(this.onUp,this)),a.getInput().moveCallback=$.proxy(this.move,this)},b.prototype.destroy=function(){a.getInput().onDown.removeAll(this),a.getInput().mouse.mouseOutCallback=null,this.group.destroy(!0),this.options=null,this.selectSignal=null},b}),define(["app/components/buttons/tabbutton","app/game","app/components/container"],function(a,b,c){"use strict";var d=function(a){c.call(this,a),this.locData=this.options.locData,this.commsData=this.options.commsData,this.selectSignal=new Phaser.Signal,this.buttons=[]};return d.prototype=Object.create(c.prototype),d.prototype.constructor=d,d.prototype.loadLevel=function(){var b,c=this,d=this.locData.levelData;$.each(new Array(d.tabs),function(d){var e;e={x:c.options.bounds.x+d*a.WIDTH,y:0,num:d},b=new a(e),b.create(),1===d&&b.goToFrame(2),b.mouseDownSignal.add($.proxy(c.click,c)),c.group.add(b.sprite),c.buttons.push(b)}),this.reload()},d.prototype.selectIndex=function(a){$.each(this.buttons,function(b,c){b===a?c.select():c.deselect()}),this.selectSignal.dispatch({index:a})},d.prototype.click=function(a){var b=this.group.getIndex(a.target.sprite);this.selectIndex(b)},d.prototype.init=function(){var a=this.commsData.selectedIndex;this.selectIndex(a)},d.prototype.create=function(){c.prototype.create.call(this)},d.prototype.reload=function(){},d.prototype.onDown=function(){console.log("down")},d.prototype.update=function(){},d.prototype.shutdown=function(){},d}),define([],function(){"use strict";var a=function(){};return a.GAME_SCENE="gameScene",a.TUTORIAL_SCENE="tutorialScene",a.COMM_SCENE="commScene",a.MAIN_SCENE="mainScene",a.LEVELS_SCENE="levelsScene",a.LOADER_SCENE="loaderScene",a}),define([],function(){"use strict";var a=function(){};return a.getData=function(b,c){return a.PAGES[b][c]||a.PAGE0_LEVEL0},a.PAGE0_LEVEL0={gunners:{x:450,y:40},killareas:{x:250,y:100},hero:{x:10,y:10,vx:0,vy:0},stars:{x:250,y:100},enemies:{x:50,y:0,vx:40,vy:0},tiles:{levelName:"level1",tileImage:"tiles1",layerName:"tileLayer1"}},a.PAGE0_LEVEL1=a.PAGE0_LEVEL0,a.PAGE0=[a.PAGE0_LEVEL0,a.PAGE0_LEVEL1],a.PAGE1_LEVEL0=a.PAGE0_LEVEL0,a.PAGE1_LEVEL1=a.PAGE0_LEVEL0,a.PAGE1=[a.PAGE1_LEVEL0,a.PAGE1_LEVEL1],a.PAGES=[a.PAGE0,a.PAGE1],a}),define([],function(){"use strict";var a=function(){};return a.getLevel=function(b,c){var d=a.PAGES[b][c];return d},a.getIndents=function(b){return a.INDENTS_TYPES.indexOf(b)>=0},a.getUnindents=function(b){return a.UNINDENTS_TYPES.indexOf(b)>=0},a.TILE_TYPE_FD=0,a.TILE_TYPE_BACK=1,a.TILE_TYPE_RPT=2,a.TILE_TYPE_ENDRPT=3,a.TILE_TYPE_JUMPBACK=4,a.TILE_TYPE_REPEAT2=5,a.TILE_TYPE_REPEAT3=6,a.TILE_TYPE_REPEAT4=7,a.TILE_TYPE_REPEAT5=8,a.TILE_TYPE_FN1=9,a.TILE_TYPE_FN2=10,a.TILE_TYPE_FN3=11,a.INDENTS_TYPES=[2],a.UNINDENTS_TYPES=[3],a.BLOCK0="assets/images/blocks/block0.png",a.BLOCK1="assets/images/blocks/block1.png",a.BLOCK2="assets/images/blocks/block2.png",a.BLOCK3="assets/images/blocks/block3.png",a.BLOCK=[a.BLOCK0,a.BLOCK1],a.PAGE0_LEVEL0={tiles:[3,4,3,3],tabs:3},a.PAGE0_LEVEL1={tiles:[2,2,3,3],tabs:2},a.PAGE0=[a.PAGE0_LEVEL0,a.PAGE0_LEVEL1],a.PAGE1_LEVEL0={tiles:[3,4,3,3],tabs:3},a.PAGE1_LEVEL1={tiles:[2,2,3,3],tabs:2},a.PAGE1=[a.PAGE1_LEVEL0,a.PAGE1_LEVEL1],a.PAGES=[a.PAGE0,a.PAGE1],a}),define([],function(){"use strict";var a=function(){};return a.GRAVITY=750,a.init=function(b){a.config=b,a.pauseSignal=new Phaser.Signal,a.alertSignal=new Phaser.Signal,a.getInstance()},a.getPhysics=function(){return a.getInstance().physics.arcade},a.getInput=function(){return a.getInstance().input},a.unPausePhysics=function(){a.physicsPaused&&(a.physicsPaused=!1,a.pauseSignal.dispatch())},a.pausePhysics=function(){a.physicsPaused||(a.physicsPaused=!0,a.pauseSignal.dispatch())},a.startPhysics=function(){a.physicsStarted?a.unpausePhysics():(a.physicsPaused=!1,a.getInstance().physics.startSystem(Phaser.Physics.ARCADE),a.getPhysics().gravity.y=a.GRAVITY)},a.getWidth=function(){var a,b;return a=window.devicePixelRatio,b=Math.min(1024,document.body.offsetWidth),a*b},a.getHeight=function(){var a,b;return a=window.devicePixelRatio,b=Math.min(768,document.body.offsetHeight),a*b},a.gonePortrait=function(){alert("portrait")},a.w=function(){return a.getInstance().camera.width},a.h=function(){return a.getInstance().camera.height},a.cx=function(){return a.w()/2},a.cy=function(){return a.h()/2},a.setupScale=function(){a.scaleManager=new Phaser.ScaleManager(a.instance,1024,768),a.scaleManager.forceLandscape=!0,a.scaleManager.scaleMode=Phaser.StageScaleMode.EXACT_FIT,a.scaleManager.pageAlignHorizontally=!0,a.scaleManager.pageAlignVertically=!0,a.scaleManager.enterPortrait.add(a.gonePortrait),a.scaleManager.forceOrientation(!0,!1)},a.create=function(){var b,c;b=a.getWidth(),c=a.getHeight(),console.log("size "+window.devicePixelRatio,document.body.offsetWidth,document.body.offsetHeight),a.instance=new Phaser.Game(b,c,Phaser.AUTO,"game",a.config),a.setupScale()},a.getInstance=function(){return a.instance||a.create(),a.instance},a}),define([],function(){"use strict";var a=function(){};return a.OPEN=0,a.LOCKED=1,a.COMPLETED=2,a}),define([],function(){"use strict";var a=function(){};return a.OPEN=0,a.LOCKED=1,a.COMPLETE=2,a}),define(["app/consts/leveldata","app/scenes/game/gamemode","app/commsdata","app/utils/storage","app/levelstate"],function(a,b,c,d,e){"use strict";var f=function(){this.level=null,this.mode=b.UNKNOWN};return f.prototype.getMode=function(){return this.mode},f.prototype.levelCompleted=function(){d.getInstance().setLevelDataForPageAndLevel(this.page,this.level,e.COMPLETED)},f.prototype.setMode=function(a){this.mode=a},f.prototype.setLocation=function(b){this.page=b.page,this.level=b.level,this.levelData=a.getLevel(this.page,this.level),c.getInstance().init(this.levelData)},f.getInstance=function(){return f.instance||(f.instance=new f),f.instance},f}),define(["app/consts/leveldata","app/game"],function(a,b){"use strict";var c=function(){this.numLoaded=0,this.loadSignal=new Phaser.Signal};return c.BG_KEY="background",c.LIST_KEY="list",c.SOUND1_KEY="sound1",c.SOUND2_KEY="sound2",c.SOUND3_KEY="sound3",c.SOUND4_KEY="sound4",c.SOUND5_KEY="sound5",c.CLOSE_KEY="close",c.TICK_KEY="tick",c.HOME_KEY="home",c.MARKER_KEY="marker",c.BLOCK_KEY0="block0",c.BLOCK_KEY1="block1",c.BLOCK_KEY2="block2",c.BLOCK_KEY3="block3",c.HERO_KEY="hero",c.STAR_KEY="star",c.ENEMY_KEY="enemy",c.LEVEL1_JSON_KEY="level1",c.LEVEL1_TILES_KEY="tiles1",c.PANEL_KEY="panel",c.ALERT_KEY="alert",c.LEFT_KEY="left",c.RIGHT_KEY="right",c.UP_KEY="up",c.DOWN_KEY="down",c.TAB_BUTTON0="tabbutton0",c.TAB_BUTTON1="tabbutton1",c.TAB_BUTTON2="tabbutton2",c.LEVEL_BUTTON="levelbutton",c.LEVEL_BUTTON_DONE="levelbuttondone",c.LEVEL_BUTTON_LOCKED="levelbuttonlocked",c.KILLAREA="killarea",c.SPRITESHEETS=[{type:"spritesheet",asset:"assets/images/buttons/levelButton.png",key:c.LEVEL_BUTTON,w:150,h:150},{type:"spritesheet",asset:"assets/images/buttons/levelButtonDone.png",key:c.LEVEL_BUTTON_DONE,w:150,h:150},{type:"spritesheet",asset:"assets/images/buttons/levelButtonLocked.png",key:c.LEVEL_BUTTON_LOCKED,w:150,h:150},{type:"spritesheet",asset:"assets/images/buttons/tabbutton0.png",key:c.TAB_BUTTON0,w:244,h:52},{type:"spritesheet",asset:"assets/images/buttons/tabbutton1.png",key:c.TAB_BUTTON1,w:244,h:52},{type:"spritesheet",asset:"assets/images/buttons/tabbutton2.png",key:c.TAB_BUTTON2,w:244,h:52},{type:"spritesheet",asset:"assets/images/buttons/yellowLeft.png",key:c.LEFT_KEY,w:120,h:120},{type:"spritesheet",asset:"assets/images/buttons/yellowRight.png",key:c.RIGHT_KEY,w:120,h:120},{type:"spritesheet",asset:"assets/images/buttons/yellowUp.png",key:c.UP_KEY,w:120,h:120},{type:"spritesheet",asset:"assets/images/buttons/yellowDown.png",key:c.DOWN_KEY,w:120,h:120},{type:"spritesheet",asset:"assets/images/buttons/close.png",key:c.CLOSE_KEY,w:50,h:50},{type:"spritesheet",asset:"assets/images/buttons/tick.png",key:c.TICK_KEY,w:80,h:80},{type:"spritesheet",asset:"assets/images/buttons/yellowList.png",key:c.LIST_KEY,w:120,h:120},{type:"spritesheet",asset:"assets/images/buttons/greenHome.png",key:c.HOME_KEY,w:120,h:120},{type:"spritesheet",asset:"assets/images/game/dude.png",key:c.HERO_KEY,w:32,h:48},{type:"spritesheet",asset:"assets/images/game/enemy.png",key:c.ENEMY_KEY,w:32,h:32},{type:"spritesheet",asset:"assets/images/buttons/pagination.png",key:c.MARKER_KEY,w:40,h:40},{type:"spritesheet",asset:"assets/images/game/firstaid.png",key:c.KILLAREA,w:32,h:32}],c.SOUNDS=[{type:"sound",asset:"assets/sound/sound1.mp3",key:c.SOUND1_KEY},{type:"sound",asset:"assets/sound/sound2.mp3",key:c.SOUND2_KEY},{type:"sound",asset:"assets/sound/sound3.mp3",key:c.SOUND3_KEY}],c.IMAGES=[{type:"image",asset:"assets/images/bg/background2.png",key:c.BG_KEY},{type:"image",asset:a.BLOCK0,key:c.BLOCK_KEY0},{type:"image",asset:a.BLOCK1,key:c.BLOCK_KEY1},{type:"image",asset:a.BLOCK2,key:c.BLOCK_KEY2},{type:"image",asset:a.BLOCK3,key:c.BLOCK_KEY3},{type:"image",asset:"assets/images/game/star2.png",key:c.STAR_KEY},{type:"image",asset:"assets/levels/tiles1.png",key:c.LEVEL1_TILES_KEY},{type:"image",asset:"assets/images/other/panel.png",key:c.PANEL_KEY},{type:"image",asset:"assets/images/other/alert.png",key:c.ALERT_KEY}],c.TILES=[{type:"tilemap",asset:"assets/levels/level1.json",key:c.LEVEL1_JSON_KEY}],c.DATA=c.SPRITESHEETS.concat(c.SOUNDS).concat(c.IMAGES).concat(c.TILES),c.prototype.loadNext=function(){var a,d,e;e=b.getInstance(),a=c.DATA[this.numLoaded],d=a.type,"image"===d?e.load.image(a.key,a.asset):"spritesheet"===d?e.load.spritesheet(a.key,a.asset,a.w,a.h):"tilemap"===d?e.load.tilemap(a.key,a.asset,null,Phaser.Tilemap.TILED_JSON):"sound"===d&&e.load.audio(a.key,[a.asset])},c.prototype.start=function(){var a=b.getInstance();a.load.onFileComplete.add($.proxy(this.fileLoaded,this)),this.loadNext()},c.prototype.fileLoaded=function(){this.numLoaded++,this.loadSignal.dispatch({numLoaded:this.numLoaded,total:c.DATA.length}),this.numLoaded<c.DATA.length&&this.loadNext()},c.prototype.destroy=function(){this.loadSignal=null},c}),define(["app/consts/appconsts","app/scenes/game/gamescene","app/scenes/loader/loaderscene","app/scenes/comms/commscene","app/scenes/main/mainscene","app/scenes/tutorial/tutorialscene","app/scenes/levels/levelsscene"],function(a,b,c,d,e,f,g){"use strict";var h=function(){};return h.getForKey=function(a){var b=h.getClassForKey(a);return new b(a)},h.getClassForKey=function(h){return h===a.GAME_SCENE?b:h===a.COMM_SCENE?d:h===a.LOADER_SCENE?c:h===a.MAIN_SCENE?e:h===a.LEVELS_SCENE?g:h===a.TUTORIAL_SCENE?f:void 0},h}),define(["app/consts/appconsts","app/utils/textfactory","app/consts/leveldata","app/scenemanager/scenefactory","app/commsdata","app/locdata","app/game","phaserstatetrans","app/utils/storage","app/levelstatus","app/utils/alertmanager"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l=function(){};return l.prototype.registerScenes=function(){this.addScene(a.GAME_SCENE),this.addScene(a.COMM_SCENE),this.addScene(a.MAIN_SCENE),this.addScene(a.LEVELS_SCENE),this.addScene(a.TUTORIAL_SCENE),this.addScene(a.LOADER_SCENE)},l.prototype.addScene=function(a){var b=d.getForKey(a);b.navigationSignal.add(this.navigationClicked,this),g.getInstance().state.add(a,b)},l.prototype.go=function(a){this.transitions.to(a)},l.prototype.levelsNavigationClicked=function(b){var c;"back"===b.button?this.go(a.MAIN_SCENE):(f.getInstance().setLocation(b),c=i.getInstance().loadLevelDataForPageAndLevel(b.page,b.level),c===j.OPEN?this.go(a.GAME_SCENE):k.makeAlert("blocked!"))},l.prototype.mainNavigationClicked=function(b){"start"===b.button?this.go(a.LEVELS_SCENE):"tutorial"===b.button&&this.go(a.TUTORIAL_SCENE)},l.prototype.commNavigationClicked=function(b){"back"===b.button?this.go(a.LEVELS_SCENE):"go"===b.button&&(g.startPhysics(),this.go(a.GAME_SCENE))},l.prototype.loaderNavigationClicked=function(){this.go(a.MAIN_SCENE)},l.prototype.tutorialNavigationClicked=function(){g.startPhysics(),this.go(a.MAIN_SCENE)},l.prototype.gameNavigationClicked=function(b){"comms"===b.target?this.go(a.COMM_SCENE):"home"===b.target?this.go(a.MAIN_SCENE):"levels"===b.target?this.go(a.LEVELS_SCENE):"refresh"===b.target&&this.go(a.GAME_SCENE)},l.prototype.navigationClicked=function(b){b.key===a.LEVELS_SCENE?this.levelsNavigationClicked(b):b.key===a.MAIN_SCENE?this.mainNavigationClicked(b):b.key===a.COMM_SCENE?this.commNavigationClicked(b):b.key===a.TUTORIAL_SCENE?this.tutorialNavigationClicked(b):b.key===a.GAME_SCENE?this.gameNavigationClicked(b):b.key===a.LOADER_SCENE&&this.loaderNavigationClicked(b)},l.prototype.preload=function(){this.transitions=g.getInstance().plugins.add(h),this.transitions.settings({duration:300,properties:{alpha:0,scale:{x:1.05,y:1.05}}}),g.getInstance().load.spritesheet("play","assets/images/buttons/yellowPlay.png",120,120),g.getInstance().load.spritesheet("bulb","assets/images/buttons/yellowBulb.png",120,120),g.getInstance().load.spritesheet("pause","assets/images/buttons/yellowPause.png",120,120),g.getInstance().load.image("sky","assets/images/bg/sky.png"),g.getInstance().load.spritesheet("loaderBar","assets/images/other/bar.png",500,60);b.make(g.cx()-300,0,"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",b.LARGE)},l.prototype.load=function(a){g.getInstance().state.start(a)},l.prototype.create=function(){this.registerScenes(),this.load(a.LOADER_SCENE)},l}),define(["app/game"],function(a){"use strict";var b=function(a,b){this.type=a,this.img=b,this.clickSignal=new Phaser.Signal,this.releaseSignal=new Phaser.Signal};return b.prototype.toString=function(){return"Block at "+this.sprite.x+","+this.sprite.y+" of type "+this.type},b.prototype.create=function(){this.sprite=new Phaser.Sprite(a.getInstance(),0,90*this.type,this.img),this.sprite.block=this,this.sprite.inputEnabled=!0,this.sprite.input.enableDrag(!1,!0),this.sprite.events.onInputDown.add(this.clickBlock,this),this.sprite.events.onDragStop.add(this.releaseBlock,this)},b.prototype.clickBlock=function(){this.clickSignal.dispatch({target:this})},b.prototype.releaseBlock=function(){this.releaseSignal.dispatch({target:this})},b}),define(["app/scenes/comms/block"],function(a){"use strict";var b=function(){};return b.create=function(b){return 0===b?new a(0,"block0"):1===b?new a(1,"block1"):2===b?new a(2,"block2"):new a(3,"block3")},b}),define(["app/scenes/comms/blocksfactory","app/game","app/scenes/comms/commslayout","app/scenes/comms/commsgroup"],function(a,b,c,d){"use strict";var e=function(a,b){this.mainGroup=null,this.targetGroups=[],this.locData=b,this.commsData=a,a.layoutSignal.add(this.onLayout,this),a.tabSignal.add(this.onSelectTab,this)};return e.prototype.onSelectTab=function(){var a=this.commsData.selectedIndex;$.each(this.targetGroups,function(b,c){c.visible=b===a}),this.currentGroup=this.targetGroups[a]},e.prototype.onLayoutGroup=function(a){var b=this;$.each(a.positions,function(c,d){var e,f,g;e=b.getBlockByIndexAndType(d.index,d.type),f=e.sprite,g=b.mainGroup.getIndex(f),g>=0&&(b.mainGroup.remove(f),b.targetGroups[a.index].add(f)),f.x=d.x,f.y=d.y}),this.update()},e.prototype.onLayout=function(a){var b=this;$.each(a,function(a,c){b.onLayoutGroup(c)})},e.prototype.loadLevel=function(){var b,c=this,d=this.locData.levelData;this.makeGroups(d.tabs),$.each(d.tiles,function(d,e){$.each(new Array(e),function(e){b=a.create(d),b.create(),b.clickSignal.add($.proxy(c.blockDown,c)),b.releaseSignal.add($.proxy(c.blockUp,c)),b.origPos={x:b.sprite.x,y:b.sprite.y},b.id={type:d,index:e},c.mainGroup.add(b.sprite)})}),this.commsData.reload(this)},e.prototype.getBlockByIndexAndType=function(a,b){var c=null;return $.each(this.targetGroups,function(d,e){e.forEach(function(d){d.block.id.type===b&&d.block.id.index===a&&(c=d.block)})}),this.mainGroup.forEach(function(d){d.block.id.type===b&&d.block.id.index===a&&(c=d.block)}),c},e.prototype.makeGroups=function(a){var c=this;$.each(new Array(a),function(){var a=new d(b.getInstance());a.create(),b.getInstance().world.add(a),c.targetGroups.push(a)}),this.mainGroup=new Phaser.Group(b.getInstance()),b.getInstance().world.add(this.mainGroup),this.currentGroup=this.targetGroups[this.commsData.selectedIndex]},e.prototype.create=function(){this.dragger=null,b.getInput().onDown.add($.proxy(this.onDown,this))
},e.prototype.onUp=function(){b.getInput().moveCallback=null},e.prototype.onDown=function(){var a=b.getInput(),c=this.mainGroup.hitTest(a)||this.currentGroup.hitTest(a);c||(this.startY=this.currentGroup.y,this.y0=a.activePointer.y,a.onUp.add($.proxy(this.onUp,this)),a.moveCallback=$.proxy(this.move,this),a.mouse.mouseOutCallback=$.proxy(this.mouseOutCallback,this))},e.prototype.mouseOutCallback=function(){this.onUp()},e.prototype.move=function(){var a=b.getInput(),d=this.commsData.currentTiles().length,e=-1*c.getBlockHeight(1)*d,f=0,g=this.startY-(this.y0-a.activePointer.y);g=Math.min(g,f),g=Math.max(g,e),this.currentGroup.y=g},e.prototype.blockDown=function(a){var b=this.mainGroup.getIndex(a.target.sprite);b>=0||(this.currentGroup.remove(a.target.sprite),this.mainGroup.add(a.target.sprite),a.target.sprite.y+=this.currentGroup.y,this.lift(a))},e.prototype.lift=function(a){this.commsData.lift(a.target)},e.prototype.drop=function(a){this.commsData.drop(a.target)},e.prototype.blockUp=function(a){var c=b.getInput();c.onUp.removeAll(),c.moveCallback=null;var d=a.target,e=d.sprite;e.x>200?(a.target.sprite.y-=this.currentGroup.y,this.drop(a)):(e.x=d.origPos.x,e.y=d.origPos.y)},e.prototype.update=function(){},e.prototype.shutdown=function(){this.commsData.layoutSignal.removeAll(this),this.commsData.tabSignal.removeAll(this)},e}),define(["app/scenes/scene","app/scenes/comms/commands","app/components/tabs","app/components/buttons/tabbutton","app/locdata","app/commsdata","app/components/buttons/navbutton","app/components/buttons/homebutton","app/game"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=function(b){a.call(this,b)};return j.prototype=Object.create(a.prototype),j.prototype.constructor=j,j.prototype.loadLevel=function(){this.commands.loadLevel(),this.tabs.loadLevel(),this.tabs.init()},j.prototype.create=function(){var j,k,l;k=e.getInstance().levelData.tabs,l=k*d.WIDTH,a.prototype.create.apply(this,arguments),this.goButton=new g({x:110,y:0}),this.commands=new b(f.getInstance(),e.getInstance()),j={x:i.w()-l,y:0,w:l,h:50},this.tabs=new c({locData:e.getInstance(),commsData:f.getInstance(),bounds:j}),this.goButton.create(),this.tabs.create(),this.commands.create(),this.tabs.selectSignal.add(this.tabSelected,this),this.backButton=new h({x:0,y:0}),this.backButton.create(),i.getInstance().world.add(this.goButton.sprite),i.getInstance().world.add(this.tabs.group),i.getInstance().world.add(this.backButton.sprite),this.addListeners(),this.loadLevel()},j.prototype.addListeners=function(){this.goButton.mouseUpSignal.add(this.goButtonClicked,this),this.backButton.mouseUpSignal.add(this.backButtonClicked,this)},j.prototype.tabSelected=function(a){f.getInstance().setSelectedTab(a)},j.prototype.backButtonClicked=function(){this.navigationSignal.dispatch({key:this.key,button:"back"})},j.prototype.goButtonClicked=function(){this.navigationSignal.dispatch({key:this.key,button:"go"})},j.prototype.update=function(){a.prototype.update.apply(this,arguments)},j.prototype.shutdown=function(){a.prototype.shutdown.apply(this,arguments),this.commands.shutdown(),this.tabs.shutdown()},j}),define(["app/game","app/scenes/comms/commslayout","app/consts/leveldata"],function(a,b){"use strict";var c=function(a){Phaser.Group.call(this,a)};return c.prototype=Object.create(Phaser.Group.prototype),c.prototype.constructor=c,c.prototype.create=function(){this.addGfx()},c.prototype.add=function(a){Phaser.Group.prototype.add.call(this,a),this.addGfx()},c.prototype.remove=function(a){Phaser.Group.prototype.remove.call(this,a),this.addGfx()},c.prototype.forEach=function(a){var b=this;Phaser.Group.prototype.forEach.call(this,function(c){c!==b.gfx&&a(c)})},c.prototype.drawGfx=function(){this.forEach(function(a){console.log(a.block+" "+a.block.id)}),this.gfx.beginFill(16724736),this.gfx.lineStyle(10,16767232,1),this.gfx.drawRect(b.XPOS,250,40*Math.random(),40*Math.random())},c.prototype.addGfx=function(){this.gfx&&(this.gfx.destroy(),Phaser.Group.prototype.remove.call(this,this.gfx),this.gfx=null),this.gfx=new Phaser.Graphics(a.getInstance(),0,0),Phaser.Group.prototype.add.call(this,this.gfx),this.drawGfx()},c}),define([],function(){"use strict";var a=function(){};return a.getBlockHeight=function(){return 75},a.TOP=60,a.XPOS=550,a.INDENT=40,a}),define(["app/game"],function(a){"use strict";var b=function(a){a.asset="killarea",this.options=a};return b.prototype.create=function(){this.makeSprite()},b.prototype.makeSprite=function(){this.sprite=new Phaser.Sprite(a.getInstance(),this.options.x,this.options.y,this.options.asset),this.sprite.enableBody=!0,a.getInstance().physics.enable(this.sprite,Phaser.Physics.ARCADE),this.body=this.sprite.body,this.body.allowGravity=!1},b.prototype.destroy=function(){this.sprite.destroy(!0),this.sprite=null},b}),Phaser.Group(Game.getInstance(),null,"bullets",!1,!0,Phaser.Physics.ARCADE),this.bullets.createMultiple(10,"killarea",0,!1),this.bullets.setAll("outOfBoundsKill",!0),this.bullets.setAll("checkWorldBounds",!0),Game.getInstance().world.add(this.bullets),define(["app/game"],function(a){"use strict";var b=function(b){a.pauseSignal.add(this.pauseChanged,this),this.options=b};return b.prototype.create=function(){this.makeSprite()},b.prototype.makeSprite=function(){this.sprite=new Phaser.Sprite(a.getInstance(),this.options.x,this.options.y,this.options.asset),this.sprite.enableBody=!0,a.getInstance().physics.enable(this.sprite,Phaser.Physics.ARCADE),this.body=this.sprite.body,this.body.gravity.y=400,this.body.velocity.x=this.options.vx,this.body.velocity.y=this.options.vy,this.body.collideWorldBounds=!0},b.prototype.pauseChanged=function(){var b=a.physicsPaused;b?this.pause():this.unPause()},b.prototype.pause=function(){this.cachedVelocity={x:this.sprite.body.velocity.x,y:this.sprite.body.velocity.y},this.body.allowGravity=!1,this.body.velocity.x=0,this.body.velocity.y=0,this.sprite.animations.stop()},b.prototype.unPause=function(){this.body.allowGravity=!0,this.body.velocity.x=this.cachedVelocity.x,this.body.velocity.y=this.cachedVelocity.y},b.prototype.destroy=function(){a.pauseSignal.removeAll(this),this.sprite.destroy(!0),this.sprite=null},b}),define(["app/game","app/scenes/game/gameview","app/commsdata","app/scenes/game/gamemode","app/locdata"],function(a,b,c,d,e){"use strict";var f=function(a){b.call(this,a),this.stackCompleteSignal=new Phaser.Signal};return f.prototype=Object.create(b.prototype),f.prototype.constructor=f,f.CHECK_STILL=500,f.prototype.nextCommand=function(){var a;this.commandNum++,this.commandNum===this.commandStack.length?this.stackCompleteSignal.dispatch({}):(a=this.commandStack[this.commandNum],this.player.setForce(a))},f.prototype.create=function(){b.prototype.create.call(this),this.commandStack=c.getInstance().getCommands(),this.commandNum=-1},f.prototype.checkCommands=function(){e.getInstance().getMode()===d.COMMANDS&&this.checkStill()},f.prototype.update=function(){b.prototype.update.call(this),this.checkCommands()},f.prototype.playBack=function(){this.checkStill()},f.prototype.checkStill=function(){var a=this;this.player&&!this.player.dead&&this.player.isStill()?this.still||(this.still=!0,this.checkEndTimeout&&clearTimeout(this.checkEndTimeout),this.checkEndTimeout=setTimeout(function(){a.nextCommand()},b.CHECK_STILL)):this.still=!1},f.prototype.destroy=function(){b.prototype.destroy.call(this),this.commandStack=null},f}),define(["app/game","app/components/buttons/controlbutton","app/components/buttons/pausebutton","app/components/container"],function(a,b,c,d){"use strict";var e=function(a){d.call(this,a),this.upSignal=new Phaser.Signal,this.downSignal=new Phaser.Signal,this.buttons=[]};return e.prototype=Object.create(d.prototype),e.prototype.constructor=e,e.prototype.create=function(){d.prototype.create.call(this);var c,e=this,f=["left","right","up","down"];c=a.h()-b.HEIGHT,$.each(new Array(4),function(a){var d,g,h;d=100+b.WIDTH*a,g={x:d,y:c,asset:f[a]},h=new b(g),h.create(),h.mouseDownSignal.add($.proxy(e.controlDown,e)),h.mouseUpSignal.add($.proxy(e.controlUp,e)),e.group.add(h.sprite),e.buttons.push(h)})},e.prototype.controlDown=function(a){var b=this.group.getIndex(a.target.sprite);this.downSignal.dispatch({index:b})},e.prototype.controlUp=function(a){var b=this.group.getIndex(a.target.sprite);this.upSignal.dispatch({index:b})},e.prototype.update=function(){},e}),define(["app/scenes/game/character","app/game"],function(a){"use strict";var b=function(b){b.asset="enemy",this.prevx=0,a.call(this,b)};return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.prototype.makeSprite=function(){a.prototype.makeSprite.call(this),this.body.bounce.x=1,this.body.bounce.y=0,this.sprite.animations.add("left",[0,1,2,3],10,!0),this.sprite.animations.add("right",[0,1,2,3],10,!0)},b.prototype.update=function(){var a=this.body.velocity.x;a>0&&this.prevx<=0?this.sprite.animations.play("left"):0>a&&this.prevx<=0&&this.sprite.animations.play("right"),this.prevx=a},b.prototype.destroy=function(){a.prototype.destroy.call(this,arguments)},b}),define(["app/components/buttons/navbutton","app/components/buttons/closebutton","app/game","app/components/buttons/listbutton","app/components/buttons/homebutton","app/components/container","app/components/abstractpopup"],function(a,b,c,d,e,f,g){"use strict";var h=function(a){a.bgasset="panel",g.call(this,a)};return h.WIDTH=800,h.HEIGHT=600,h.prototype=Object.create(g.prototype),h.prototype.constructor=h,h.prototype.addButton=function(a,b,c){var d=new a({x:b,y:c});d.create(),d.mouseUpSignal.add(this.buttonUp,this),this.buttonGroup.add(d.sprite),this.buttons.push(d)},h.prototype.addButtons=function(){g.prototype.addButtons.call(this);var c=this.bounds.y+this.bounds.h/2-a.HEIGHT/2;this.addButton(a,200,c),this.addButton(a,350,c),this.addButton(d,500,c),this.addButton(e,650,c),this.addButton(a,750,c),this.addButton(b,this.bounds.x+this.bounds.w-50,this.bounds.y+10)},h}),define([],function(){"use strict";var a=function(){};return a.UNKNOWN=0,a.COMMANDS=1,a.INTERACTIVE=2,a}),define(["app/scenes/scene","app/components/buttons/navbutton","app/components/buttons/pausebutton","app/commsdata","app/locdata","app/scenes/game/controls","app/scenes/game/gamemode","app/scenes/game/commgameview","app/utils/alertmanager","app/game","app/consts/layoutdata"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l=function(b){a.call(this,b),this.gameMenu=null};return l.prototype=Object.create(a.prototype),l.prototype.constructor=l,l.prototype.addControls=function(){this.controls=new f({bounds:{x:0,y:0}}),this.controls.create(),j.getInstance().world.add(this.controls.group),this.controls.upSignal.add(this.gameView.controlUp,this.gameView),this.controls.downSignal.add(this.gameView.controlDown,this.gameView)},l.prototype.showControls=function(a){this.controls.visible=a},l.prototype.create=function(){a.prototype.create.apply(this,arguments),this.gameView=new h(k.getData(0,0)),this.gameView.stackCompleteSignal.add(this.stackComplete,this),this.gameView.deadSignal.add(this.onDead,this),this.pauseButton=new c({x:j.w()-c.WIDTH,y:0}),this.gameView.create(),this.pauseButton.create(),this.pauseButton.sprite.fixedToCamera=!0,this.pauseButton.mouseUpSignal.add(this.buttonClicked,this),j.getInstance().world.add(this.pauseButton.sprite),e.getInstance().getMode()!==g.COMMANDS&&this.addControls(),this.checkLaunch()},l.prototype.onDead=function(){this.showPauseMenu()},l.prototype.stackComplete=function(){var a=!0;e.getInstance().levelCompleted(a)},l.prototype.checkLaunch_playback=function(){setTimeout($.proxy(this.gameView.playBack,this.gameView),500)},l.prototype.checkLaunch=function(){e.getInstance().getMode()===g.UNKNOWN?this.showGrowlMenu():e.getInstance().getMode()===g.COMMANDS&&this.showGrowlMenu()},l.prototype.showPauseMenu=function(){i.makePauseMenu("pause",$.proxy(this.pauseMenuClick,this))},l.prototype.showGrowlMenu=function(){i.makeGrowl("Use the buttons to...",null)},l.prototype.pauseMenuClick=function(a){0===a.index?e.getInstance().setMode(g.INTERACTIVE):1===a.index?(e.getInstance().setMode(g.COMMANDS),this.navigationSignal.dispatch({key:this.key,target:"comms"})):2===a.index?this.navigationSignal.dispatch({key:this.key,target:"levels"}):3===a.index?this.navigationSignal.dispatch({key:this.key,target:"home"}):4===a.index?this.navigationSignal.dispatch({key:this.key,target:"refresh"}):5===a.index},l.prototype.hideMenu=function(){},l.prototype.buttonClicked=function(){this.showPauseMenu()},l.prototype.update=function(){a.prototype.update.apply(this,arguments),this.gameView.update()},l.prototype.shutdown=function(){a.prototype.shutdown.apply(this,arguments),this.pauseButton.mouseUpSignal.removeAll(this),this.gameView.stackCompleteSignal.removeAll(this),this.hideMenu(),this.gameView.destroy(),this.gameView=null,this.gameMenu&&(this.gameMenu.destroy(),this.gameMenu=null),this.controls&&(this.controls.upSignal.removeAll(this.gameView),this.controls.downSignal.removeAll(this.gameView),this.controls.destroy(),this.controls=null)},l}),define(["app/game","app/scenes/game/player","app/scenes/game/enemy","app/scenes/game/killarea","app/scenes/game/gunner","app/components/background","app/scenes/game/stars","app/commsdata","app/locdata","app/scenes/game/platforms","app/scenes/game/gamemode"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k=function(a){this.options=a,this.deadSignal=new Phaser.Signal};return k.prototype.controlUp=function(a){this.player.controlUp(a)},k.prototype.controlDown=function(a){this.player.controlDown(a)},k.prototype.addBg=function(){this.bg=new f({asset:"background"}),this.bg.create(),a.getInstance().world.add(this.bg.sprite)},k.prototype.addPlatforms=function(){this.platforms=new j(this.options.tiles),this.platforms.create(),a.getInstance().world.add(this.platforms.tileMapLayer)},k.prototype.addPlayer=function(){this.player=new b(this.options.hero),this.player.create(),this.player.deadSignal.add(this.onDead,this),a.getInstance().world.add(this.player.sprite)},k.prototype.onDead=function(){this.player.destroy(),this.player.deadSignal.removeAll(this),this.player=null,this.deadSignal.dispatch()},k.prototype.addBullets=function(){this.bullets=new Bullets,this.bullets.create(),a.getInstance().world.add(this.bullets.group)},k.prototype.addStars=function(){this.stars=new g(this.options.stars),this.stars.create(),a.getInstance().world.add(this.stars.group)},k.prototype.addEnemies=function(){this.enemy1=new c(this.options.enemies),this.enemy1.create(),a.getInstance().world.add(this.enemy1.sprite)},k.prototype.addHome=function(){this.home=new Home(this.options.home),this.home.create(),a.getInstance().world.add(this.home.sprite)},k.prototype.addKillAreas=function(){this.kill1=new d(this.options.killareas),this.kill1.create(),a.getInstance().world.add(this.kill1.sprite)},k.prototype.shoot=function(a){var b=this.bullets.group.getFirstExists(!1);b&&(b.reset(a.target.sprite.x,a.target.sprite.y),b.body.allowGravity=!1,b.body.velocity.x=-300,b.body.velocity.y=0)},k.prototype.addGunners=function(){this.gun1=new e(this.options.gunners),this.gun1.create(),this.gun1.shootSignal.add(this.shoot,this),a.getInstance().world.add(this.gun1.sprite)},k.prototype.create=function(){this.addBg(),this.addPlatforms(),this.addPlayer(),this.addBullets(),this.addGunners(),this.addEnemies(),this.addHome(),this.addKillAreas(),this.addStars(),a.getInstance().camera.follow(this.player.sprite)},k.prototype.collide=function(){var b=a.getPhysics();this.player&&!this.player.dead&&(b.collide(this.player.sprite,this.platforms.tileMapLayer),b.overlap(this.player.sprite,this.stars.group,this.collectStar,null,this),b.overlap(this.player.sprite,this.enemy1.sprite,this.hitEnemy,null,this),b.overlap(this.player.sprite,this.kill1.sprite,this.hitKillArea,null,this)),b.collide(this.kill1.sprite,this.platforms.tileMapLayer),b.collide(this.enemy1.sprite,this.platforms.tileMapLayer),b.collide(this.stars.group,this.platforms.tileMapLayer)},k.prototype.update=function(){this.collide(),this.player&&this.player.update(),this.stars.update(),this.enemy1.update(),this.gun1.update()},k.prototype.collectStar=function(a,b){b.kill()},k.prototype.hitEnemy=function(){this.player.kill()},k.prototype.hitKillArea=function(){},k.prototype.destroy=function(){this.bg.destroy(),this.platforms.destroy(),this.player&&this.player.destroy(),this.bg=null,this.platforms=null,this.player=null},k}),define(["app/game"],function(a){"use strict";var b=function(a){a.asset="killarea",this.options=a,this.shootSignal=new Phaser.Signal};return b.prototype.create=function(){this.makeSprite()},b.prototype.makeSprite=function(){this.sprite=new Phaser.Sprite(a.getInstance(),this.options.x,this.options.y,this.options.asset),this.sprite.enableBody=!0,a.getInstance().physics.enable(this.sprite,Phaser.Physics.ARCADE),this.body=this.sprite.body,this.body.allowGravity=!1},b.prototype.update=function(){Math.random()<.003&&this.shootSignal.dispatch({target:this})},b.prototype.destroy=function(){this.shootSignal.removeAll(this),this.sprite.destroy(!0),this.sprite=null},b}),define(["app/game"],function(a){"use strict";var b=function(a){a.asset="killarea",this.options=a};return b.prototype.create=function(){this.makeSprite()},b.prototype.makeSprite=function(){this.sprite=new Phaser.Sprite(a.getInstance(),this.options.x,this.options.y,this.options.asset),this.sprite.enableBody=!0,a.getInstance().physics.enable(this.sprite,Phaser.Physics.ARCADE),this.body=this.sprite.body,this.body.allowGravity=!1},b.prototype.destroy=function(){this.sprite.destroy(!0),this.sprite=null},b}),define([],function(){"use strict";var a=function(a){this.body=a,this.state=null};return a.MAX_SPEED=16,a.MAX_VX=.1,a.UP="U",a.UPRIGHT="UR",a.UPLEFT="UL",a.RIGHT="R",a.LEFT="L",a.prototype.setState=function(a){this.state=a},a.prototype.getState=function(){return this.state},a.prototype.matches=function(a){return this.state&&this.state.indexOf(a)>=0},a.prototype.isLeft=function(){return this.matches(a.LEFT)},a.prototype.isRight=function(){return this.matches(a.RIGHT)},a.prototype.isUp=function(){return this.matches(a.UP)},a.prototype.remove=function(a){this.state&&(this.state=this.state.replace(a,""))},a.prototype.isStill=function(){var b=this.body.velocity,c=this.body.speed,d=c<=a.MAX_SPEED&&Math.abs(b.x)<=a.MAX_VX&&this.body.blocked.down;return d},a}),define(["app/game"],function(a){"use strict";var b=function(a){this.options=a};return b.prototype.create=function(){this.map=new Phaser.Tilemap(a.getInstance(),this.options.levelName),this.map.addTilesetImage(this.options.tileImage),this.map.setCollisionByExclusion([]),this.tileMapLayer=this.map.createLayer(this.options.layerName),this.tileMapLayer.resizeWorld()},b.prototype.destroy=function(){this.tileMapLayer.destroy(!0),this.tileMapLayer=null,this.map=null},b}),define(["app/scenes/game/character","app/scenes/game/objectstate","app/game"],function(a,b,c){"use strict";var d=function(b){b.asset="hero",this.dead=!1,this.deadSignal=new Phaser.Signal,a.call(this,b)};return d.prototype=Object.create(a.prototype),d.prototype.constructor=d,d.VELX=200,d.VELY=700,d.FORCE_DELAY=20,d.prototype.makeSprite=function(){a.prototype.makeSprite.call(this),this.body.bounce.y=.2,this.sprite.animations.add("left",[0,1,2,3],10,!0),this.sprite.animations.add("right",[5,6,7,8],10,!0),this.state=new b(this.body)},d.prototype.kill=function(){this.sprite.enableBody=!1,this.dead=!0,this.sprite.body.velocity.y=-10,this.sprite.body.velocity.x=0,c.getInstance().camera.unfollow()},d.prototype.isStill=function(){return this.state.isStill()},d.prototype.setForce=function(a){this.state.setState(a),this.forceTime=0,this.forced=!0},d.prototype.controlDown=function(a){null==this.state.getState()&&(0===a.index?this.setForce(b.LEFT):1===a.index?this.setForce(b.RIGHT):2===a.index?this.setForce(b.UPLEFT):3===a.index&&this.setForce(b.UPRIGHT))},d.prototype.controlUp=function(){},d.prototype.updateDead=function(){var a=c.getInstance().camera.y+c.h()-this.sprite.y;console.log("dy "+a),0>a&&this.deadSignal.dispatch()},d.prototype.updateNormal=function(){var a,b,c;this.sprite.body.velocity.x=0,a=this.state.isLeft(),b=this.state.isRight(),c=this.state.isUp(),a?(this.sprite.body.velocity.x=-d.VELX,this.sprite.animations.play("left")):b?(this.sprite.body.velocity.x=d.VELX,this.sprite.animations.play("right")):(this.sprite.animations.stop(),this.sprite.frame=4),c&&(this.sprite.body.velocity.y=-d.VELY,this.state.remove("U")),this.forced&&(this.forceTime++,this.forceTime===d.FORCE_DELAY&&(this.state.setState(null),this.forced=!1))},d.prototype.update=function(){c.physicsPaused||(this.dead?this.updateDead():this.updateNormal())},d.prototype.destroy=function(){a.prototype.destroy.call(this,arguments)},d}),define(["app/game"],function(a){"use strict";var b=function(){};return b.prototype.create=function(){this.group=new Phaser.Group(a.getInstance()),a.getInstance().physics.enable(this.group,Phaser.Physics.ARCADE),this.group.enableBody=!0;var b=this.group.create(200,0,"star");b.body.bounce.y=.1},b.prototype.update=function(){},b}),define(["app/game","app/components/buttongrid","app/components/buttons/levelbadge","app/utils/storage"],function(a,b,c,d){"use strict";var e=function(){};return e.prototype.getNumPages=function(){return 3},e.prototype.addPage=function(d,e,f,g,h){var i,j,k,l,m,n,o,p;p=50,l=a.w(),m=a.h(),n=(l-800)/2,o=(m-600)/2,k={x:d*l+n,y:o,w:800,h:600},i={bounds:k,numX:e,numY:f,buttonClass:c,config:h},j=new b(i),j.create(),g.add(j)},e.prototype.addAll=function(a){var b=d.getInstance().loadLevelDataForPage(0),c=d.getInstance().loadLevelDataForPage(1),e=d.getInstance().loadLevelDataForPage(2);this.addPage(0,3,3,a,b),this.addPage(1,3,3,a,c),this.addPage(2,3,3,a,e)},e}),define(["jquery","app/scenes/scene","app/components/scroller","app/components/pager","app/utils/textfactory","app/components/buttons/levelsbutton","app/components/buttons/homebutton","app/game","app/scenes/levels/leveldataprovider","app/utils/storage"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=function(a){b.call(this,a)};return j.prototype=Object.create(b.prototype),j.prototype.constructor=j,j.prototype.create=function(){b.prototype.create.apply(this,arguments);var a={snapX:100,dataProvider:new i};this.scroller=new d(a),this.scroller.create(),this.scroller.selectSignal.add(this.levelSelect,this),this.text=e.make(h.cx()-300,0,"Choose a level",e.LARGE),this.backButton=new g({x:0,y:0}),this.backButton.create(),h.getInstance().world.add(this.backButton.sprite),h.getInstance().world.add(this.scroller.group),h.getInstance().world.add(this.text),this.backButton.mouseUpSignal.add(this.backButtonClicked,this)},j.prototype.enableAllInput=function(){b.prototype.enableAllInput.call(this),this.backButton.enableInput(),this.scroller.group.enableInput()},j.prototype.disableAllInput=function(){b.prototype.disableAllInput.call(this),this.backButton.disableInput(),this.scroller.group.disableInput()},j.prototype.backButtonClicked=function(){this.navigationSignal.dispatch({key:this.key,button:"back"})},j.prototype.levelSelect=function(b){var c=a.extend({},{key:this.key,button:"level"},b);this.navigationSignal.dispatch(c)},j.prototype.update=function(){b.prototype.update.apply(this,arguments)},j.prototype.shutdown=function(){b.prototype.shutdown.apply(this,arguments),this.scroller.selectSignal.removeAll(this),this.backButton.mouseUpSignal.removeAll(this),this.backButton.destroy(),this.scroller.destroy(),this.backButton=null,this.text=null,this.scroller=null},j}),define(["app/scenes/scene","app/preloader/preloader","app/components/buttons/navbutton","app/scenes/game/commgameview","app/consts/layoutdata","app/components/buttons/bulbbutton","app/components/loaderbar","app/utils/textfactory","app/game"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=function(b){a.call(this,b),this.numLoaded=0};return j.created=!1,j.prototype=Object.create(a.prototype),j.prototype.constructor=j,j.prototype.preload=function(){this.addChildren(),this.preloader=new b,this.preloader.loadSignal.add(this.loadProgress,this),this.preloader.start()},j.prototype.addChildren=function(){a.prototype.addChildren.call(this),this.addBar(),this.addText()},j.prototype.addBar=function(){var a,b,c;a=i.cx()-g.WIDTH/2,b=i.cy()-20,c={x:a,y:b},this.loaderBar=new g(c),this.loaderBar.create(),i.getInstance().world.add(this.loaderBar.sprite)},j.prototype.addText=function(){this.label=h.make(i.cx()-300,0,"Loading...",h.LARGE),i.getInstance().world.add(this.label)},j.prototype.loadProgress=function(a){var b=Math.round(100*a.numLoaded/a.total);this.loaderBar.goToPercent(b)},j.prototype.create=function(){a.prototype.create.call(this);var b=this;this.loaderBar.goToPercent(100),setTimeout(function(){b.navigationSignal.dispatch({key:b.key})},700)},j.prototype.update=function(){a.prototype.update.apply(this,arguments)},j.prototype.shutdown=function(){a.prototype.shutdown.apply(this,arguments),this.loaderBar.destroy(),this.preloader&&(this.preloader.loadSignal.removeAll(this),this.preloader.destroy()),this.loaderBar=null,this.preloader=null},j}),define(["app/scenes/scene","app/preloader/preloader","app/components/buttons/navbutton","app/scenes/game/commgameview","app/consts/layoutdata","app/components/buttons/bulbbutton","app/components/loaderbar","app/utils/textfactory","app/game"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=function(b){a.call(this,b),this.numLoaded=0};return j.created=!1,j.prototype=Object.create(a.prototype),j.prototype.constructor=j,j.prototype.preload=function(){},j.prototype.addChildren=function(){a.prototype.addChildren.call(this),this.gameView=new d(e.getData(0,0)),this.gameView.create(),this.addText(),this.addButtons()},j.prototype.addText=function(){this.label=h.make(i.cx()-300,0,"Main menu",h.LARGE),i.getInstance().world.add(this.label)},j.prototype.addButtons=function(){var a=100;this.startButton=new c({x:i.cx()-c.WIDTH-a,y:i.h()+100}),this.tutorialButton=new f({x:i.cx()+a,y:i.h()+100}),this.startButton.create(),this.tutorialButton.create(),this.startButton.mouseUpSignal.add(this.startButtonClicked,this),this.tutorialButton.mouseUpSignal.add(this.tutorialButtonClicked,this),i.getInstance().world.add(this.startButton.sprite),i.getInstance().world.add(this.tutorialButton.sprite)},j.prototype.create=function(){a.prototype.create.call(this),this.showButtons()},j.prototype.showButtons=function(){var a,b,c;a={y:i.h()+100},b={y:i.cy()},c={y:i.cy()},i.getInstance().add.tween(this.startButton.sprite).to(b,250,Phaser.Easing.Quadratic.Out,!0,20,!1),i.getInstance().add.tween(this.tutorialButton.sprite).to(c,250,Phaser.Easing.Quadratic.Out,!0,20,!1)},j.prototype.startButtonClicked=function(){this.navigationSignal.dispatch({key:this.key,button:"start"})},j.prototype.tutorialButtonClicked=function(){this.navigationSignal.dispatch({key:this.key,button:"tutorial"})},j.prototype.update=function(){a.prototype.update.apply(this,arguments),this.gameView.update()},j.prototype.shutdown=function(){a.prototype.shutdown.apply(this,arguments),this.startButton.mouseUpSignal.removeAll(this),this.tutorialButton.mouseUpSignal.removeAll(this),this.startButton=null,this.tutorialButton=null},j}),define(["app/game","app/components/background"],function(a,b){"use strict";var c=function(a){this.key=a,this.navigationSignal=new Phaser.Signal};return c.prototype.onAlert=function(a){a.show?this.disableAllInput():this.enableAllInput()},c.prototype.disableAllInput=function(){},c.prototype.enableAllInput=function(){},c.prototype.addChildren=function(){this.bg=new b({asset:"sky"}),this.bg.create(),a.getInstance().world.add(this.bg.sprite)},c.prototype.create=function(){this.addChildren(),a.alertSignal.add($.proxy(this.onAlert,this))},c.prototype.update=function(){},c.prototype.shutdown=function(){a.alertSignal.removeAll(this)},c}),define(["app/scenes/scene","app/preloader/preloader","app/components/buttons/homebutton","app/utils/textfactory","app/game"],function(a,b,c,d,e){"use strict";var f=function(b){a.call(this,b)};return f.prototype=Object.create(a.prototype),f.prototype.constructor=f,f.prototype.create=function(){a.prototype.create.apply(this,arguments),this.label=d.make(e.cx()-300,50,"Tutorial",d.LARGE),this.startButton=new c({x:0,y:0}),this.startButton.create(),this.startButton.mouseUpSignal.add(this.startButtonClicked,this),e.getInstance().world.add(this.startButton.sprite),e.getInstance().world.add(this.label)},f.prototype.startButtonClicked=function(){this.navigationSignal.dispatch({key:this.key})},f.prototype.tutorialButtonClicked=function(){this.navigationSignal.dispatch({key:this.key})},f.prototype.update=function(){a.prototype.update.apply(this,arguments)},f.prototype.shutdown=function(){a.prototype.shutdown.apply(this,arguments)},f}),define(["app/game","app/components/alert","app/scenes/game/gamemenu","app/components/growl"],function(a,b,c,d){"use strict";var e=function(){};return e.close=function(){e.alert&&(e.alert.selectSignal.removeAll(e),e.alert.destroy(),e.alert=null,a.alertSignal.dispatch({show:!1}))},e.alertClick=function(){e.closeAlert()},e.make=function(b,c,d){var f,g;f=(a.w()-b.WIDTH)/2,g=(a.h()-b.HEIGHT)/2,e.close(),e.alert=new b({label:c,bounds:{x:f,y:g,w:b.WIDTH,h:b.HEIGHT}}),e.alert.create(),a.getInstance().world.add(e.alert.group),e.alert.selectSignal.add($.proxy(this.buttonClick,this,d)),a.alertSignal.dispatch({show:!0})},e.buttonClick=function(a,b){e.close(),a&&a(b)},e.makeGrowl=function(a,b){e.make(d,a,b)},e.makePauseMenu=function(b,d){e.make(c,b,d),a.pausePhysics()},e.makeAlert=function(a,c){e.make(b,a,c)},e}),define(["phaser"],function(a){"use strict";a.Group.prototype.hitTest=function(a){var b=!1,c=a.activePointer;return this.forEachAlive(function(d){var e=a.getLocalPosition(d,c);a.hitTest(d,c,e)&&(b=!0)}),b},a.Group.prototype.enableInput=function(){this.forEach(function(b){b instanceof a.Group?b.enableInput():b instanceof a.Button&&(b.inputEnabled=!0)})},a.Group.prototype.disableInput=function(){this.forEach(function(b){b instanceof a.Group?b.disableInput():b instanceof a.Button&&(b.inputEnabled=!1)})}}),define(["jquery","app/levelstate"],function(a,b){"use strict";var c=function(){};return c.LEVEL_PROGESS_KEY="levelData",c.DEFAULT_PROGRESS=[],c.DEFAULT_PROGRESS.push([b.OPEN,b.OPEN,b.OPEN,b.OPEN,b.OPEN,b.OPEN,b.OPEN,b.OPEN,b.OPEN]),c.DEFAULT_PROGRESS.push([b.LOCKED,b.LOCKED,b.LOCKED,b.LOCKED,b.LOCKED,b.LOCKED,b.LOCKED,b.LOCKED,b.LOCKED]),c.DEFAULT_PROGRESS.push([b.COMPLETED,b.COMPLETED,b.COMPLETED,b.COMPLETED,b.COMPLETED,b.COMPLETED,b.COMPLETED,b.COMPLETED,b.COMPLETED]),c.prototype.init=function(){var a;this.cache=[],this.persistence=localStorage,a=this.loadAllLevelData(),a||this.saveForKey(c.LEVEL_PROGESS_KEY,c.DEFAULT_PROGRESS)},c.prototype.saveForKey=function(a,b){this.persistence.setItem(a,JSON.stringify(b)),this.addToCache(a,b)},c.prototype.loadAllLevelData=function(){return this.getForKey(c.LEVEL_PROGESS_KEY)},c.prototype.setLevelDataForPageAndLevel=function(a,b,d){var e=this.loadAllLevelData();e[a][b]=d,this.saveForKey(c.LEVEL_PROGESS_KEY,e)},c.prototype.loadLevelDataForPageAndLevel=function(a,b){var c=this.loadLevelDataForPage(a);return c[b]},c.prototype.loadLevelDataForPage=function(a){var b=this.loadAllLevelData();return b[a]},c.prototype.addToCache=function(a,b){this.cache[a]=b},c.prototype.getForKey=function(b){var c;return c=this.cache[b],c||(c=this.persistence.getItem(b),c&&(c=a.parseJSON(c),this.addToCache(b,c))),c},c.getInstance=function(){return c.instance||(c.instance=new c,c.instance.init()),c.instance},c}),define(["app/game"],function(a){"use strict";var b=function(){};return b.LARGE=0,b.MEDIUM=1,b.SMALL=2,b.DEFAULT_FONT_LARGE={font:"100px Yanone",align:"center"},b.DEFAULT_FONT_MEDIUM={font:"60px Yanone",align:"center"},b.DEFAULT_FONT_SMALL={font:"40px Yanone",align:"center"},b.FONTS=[b.DEFAULT_FONT_LARGE,b.DEFAULT_FONT_MEDIUM,b.DEFAULT_FONT_SMALL],b.centreX=function(){},b.make=function(c,d,e,f){var g,h,i;return g=b.FONTS[f],h=new Phaser.Text(a.getInstance(),c,d,e,g),h.stroke="#777777",h.strokeThickness=2,i=h.context.createLinearGradient(0,0,0,h.canvas.height),i.addColorStop(0,"#ffffff"),i.addColorStop(1,"#eeeeee"),h.fill=i,h.setShadow(2,2,"rgba(1, 1, 1, 0.4)",5),h
},b}),define(function(){"use strict";var a=function(){};return a.extends=function(a,b){var c=function(){};c.prototype=Object.create(b.prototype),a.prototype=new c,a.prototype.constructor=a},a});